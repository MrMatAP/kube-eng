#
# Main configuration file for your cluster
# Top-level variables with an underscore in them are overridden by the Makefile
# Variables within a dictionary must be edited straight in the cluster configuration file
---
dist_dir: ""
admin_password: ""
cluster_name: ""
prometheus_chart: ""
postgres_chart: ""
keycloak_chart: ""
grafana_chart: ""
jaeger_chart: ""
kiali_chart: ""
stack_chart: ""
cloud_provider_mdns: ""
user_id: ""

cluster:
  control_plane_nodes: 1
  worker_nodes: 3
  mesh: istio-experimental
  istio_profile: minimal
  gateway_api: true
  cert_manager_ns: cert-manager
  edge: istio-gateway-api-experimental
  edge_ns: edge

host:
  tools:
    kind: /opt/homebrew/bin/kind
    istioctl: /opt/homebrew/bin/istioctl
    kubectl: /opt/homebrew/bin/kubectl
    kustomize: /opt/homebrew/bin/kustomize
    docker: /usr/local/bin/docker
    named: /opt/homebrew/sbin/named
    step: /opt/homebrew/bin/step
  cloud_provider_kind:
    enabled: true
    url: https://github.com/kubernetes-sigs/cloud-provider-kind/releases/download/v0.6.0/cloud-provider-kind_0.6.0_darwin_arm64.tar.gz
  cloud_provider_mdns:
    enabled: true
  resolver:
    enabled: false
    forwarder: 8.8.8.8
  pki:
    enabled: true
    name: local-pki
    port: 9000
  registry:
    enabled: true
    name: registry
    port: 5001
    image: "registry:2"
    volume:
      name: "registry-volume"
  postgresql:
    enabled: true
    name: pg
    port: 5432
    image: "postgres:15"
    volume:
      name: "pg-volume"

stack:
  ns: stack
  prometheus:
    enabled: false
    ns: stack
    hostname: prometheus.covenant.local
    # Use LATEST=$(curl -s https://api.github.com/repos/prometheus-operator/prometheus-operator/releases/latest | jq -cr .tag_name)
    # to find the latest version
    bundle: https://raw.githubusercontent.com/prometheus-operator/prometheus-operator/refs/tags/v0.82.0/bundle.yaml
  alloy:
    enabled: true
    ns: stack
  keycloak:
    enabled: false
    preheat_images:
    - registry: quay.io
      repository: keycloak
      image: keycloak
      tag: 26.0.7
    ns: keycloak
    hostname: keycloak.covenant.local
  grafana:
    enabled: false
    preheat_images:
    - registry: docker.io
      repository: library
      image: busybox
      tag: 1.31.1
    - registry: docker.io
      repository: curlimages
      image: curl
      tag: 7.85.0
    - registry: quay.io
      repository: kiwigrid
      image: k8s-sidecar
      tag: 1.28.0
    - registry: docker.io
      repository: grafana
      image: grafana
      tag: 11.4.0
    ns: grafana
    hostname: grafana.covenant.local
    client_id: grafana
    admin_user: admin
  jaeger:
    enabled: false
    preheat_images:
    - registry: docker.io
      repository: bitnami
      image: jaeger
      tag: 2.5.0-debian-12-r0
    - registry: docker.io
      repository: bitnami
      image: cassandra
      tag: 5.0.3-debian-12-r9
    - registry: docker.io
      repository: bitnami
      image: cassandra
      tag: 5.0.4-debian-12-r2
    ns: jaeger
    hostname: jaeger.covenant.local
  kiali:
    enabled: false
    preheat_images:
    - registry: quay.io
      repository: kiali
      image: kiali
      tag: v2.8.0
    ns: istio-system
    hostname: kiali.covenant.local

preheat:
- registry: quay.io
  repository: prometheus-operator
  image: prometheus-config-reloader
  tag: v0.82.0
- registry: quay.io
  repository: prometheus-operator
  image: prometheus-operator
  tag: v0.82.0
- registry: quay.io
  repository: prometheus
  image: node-exporter
  tag: v1.8.2
- registry: quay.io
  repository: prometheus
  image: prometheus
  tag: v3.2.1
- registry: registry.k8s.io
  repository: kube-state-metrics
  image: kube-state-metrics
  tag: v2.14.0
